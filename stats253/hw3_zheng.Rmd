Charles Zheng Homework 3
========================================================

## Computation

Consider a CAR model, with a weight matrix $W$ which is not necessarily symmetric and has zero diagonal.
Let $\tilde{W}$ denote the lower triangle of $W$.
We have
$$
\frac{p(\epsilon)}{p(0)} = \exp\left(-\frac{1}{2\tau^2} \epsilon^T (I - 2\phi \tilde{W}) \epsilon\right)
$$
which is equivalent to
$$
\frac{p(\epsilon)}{p(0)} = \exp\left(-\frac{1}{2\tau^2} \epsilon^T (I - \phi (\tilde{W} + \tilde{W}^T)) \epsilon\right).
$$
Since $\tilde{W} + \tilde{W}^T$ is symmetric, we might as well assume that $W$ is symmetric.
Hence
$$
\epsilon \sim N(0, \tau^2(I - \phi W)^{-1})
$$
Now suppose
$$
W = V D V^T.
$$
Then
$$
\tau^2 (I - \phi W)^{-1} = \tau^2 V (I - \phi D)^{-1} V^T 
$$

## Model

Since we have Poisson data, we use the model
$$
y \sim Poisson(e^{X\beta + \epsilon})
$$
where
$$
\epsilon \sim N(0, \tau^2(I - \phi W)^{-1})
$$
Here the model is no longer a CAR model due to the Poisson transformation.
Instead, $\epsilon$ act as latent variables which induce spatial correlation.

```{r, warning=FALSE, message=FALSE}
library(maptools)
library(RColorBrewer)
library(classInt)
library(magrittr)
library(spdep)
library(pracma)
```