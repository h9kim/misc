---
title: "Random images misclassification rate"
output: html_document
---

## Source code

```{r}
source("source.R")
```

## Model

Model: consider a spherical parameter space with radius $R$, $\Omega = B_R(0) \in \mathbb{R}^d$.

Let $P$ be a distribution with density $p(x)$ supported on $\Omega$.

Generate $k$ means, $\mu_i \sim P$. (Each mean belongs to an image.)  Let $\sigma$ be a noise parameter.

Generate $n$ observations per mean, $x_{i, 1},..., x_{i, n} \sim N(\mu_i, \sigma^2 I)$.

From $n_{tr}$ observations per mean estimate $\hat{\mu}_i$ for $i = 1,..., k$.

Then assess the misclassification rate on the remaining $k(n-n_{tr})$ test points.

Set distribution $P$:

```{r}
d <- 10L
b1 <- new("ball", radius = 2, dimension = d)
k <- 10L
centers <- sample_points(b1, k)
covs <- 2 * identity_covs(d, k)
wts <- (temp <- runif(k))/sum(temp)
mb1 <- new("mixture_in_ball", domain = b1,
           centers = centers, covariances = covs,
           weights = wts)
```

Specify simulation parameters:

```{r}
pars <- new("simulation_params",
           prior = mb1,
           sigma = diag(rep(1, d)),
           k = 10L,
           n = 13L,
           n_tr = 10L)
```

Run simulation:
```{r}
sr <- new("simulation_detailed_results", pars)
print(sr)
```

Run multiple simulations:
```{r}
srs <- new("simulation_summary_results", pars, 10L)
print(srs)
```

Mean rates for each angle
```{r, fig.width=6, fig.height=3}
plot(1:5)
```

