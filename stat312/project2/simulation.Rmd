---
title: "Random images misclassification rate"
output: html_document
---

## Source code

```{r}
source("source.R")

d <- 2
b1 <- new("ball", radius = 2, dimension = d)
k <- 3
centers <- sample_points(b1, k)
covs <- identity_covs(d, k)
wts <- (temp <- runif(k))/sum(temp)
mb1 <- new("mixture_in_ball", domain = b1,
           centers = centers, covariances = covs,
           weights = wts)
mb1@rej_prob

mb0 <- new("mixture_in_ball", domain = b1,
           centers = matrix(0, 2, 1),
           covariances = 10 * identity_covs(2, 1),
           weights = 1)
mb0@rej_prob

sample_points(mb1, 5)
```

## Model

Model: consider a spherical parameter space with radius $R$, $\Omega = B_R(0) \in \mathbb{R}^d$.

Let $P$ be a distribution with density $p(x)$ supported on $\Omega$.

Generate $k$ means, $\mu_i \sim P$. (Each mean belongs to an image.)  Let $\sigma$ be a noise parameter.

Generate $n$ observations per mean, $x_{i, 1},..., x_{i, n} \sim N(\mu_i, \sigma^2 I)$.

From $n_{tr}$ observations per mean estimate $\hat{\mu}_i$ for $i = 1,..., k$.

Then assess the misclassification rate on the remaining $k(n-n_{tr})$ test points.

Set parameters:

```{r}
# PARAMETERS
5
```

Generate random means:

```{r}
5
```

Mean rates for each angle
```{r, fig.width=6, fig.height=3}
plot(1:5)
```

