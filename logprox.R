zs <- (1:5000)/10000

lz <- log(zs)
lz2 <- log(zs + 0.001)
tz <- (zs-1) - (zs-1)^2/2 + (zs-1)^3/3
tz <- 2 * ( 
  (zs-1)/(zs+1)  + (1/3) * ( (zs-1)/(zs+1) )^3 + (1/5) *( (zs-1)/(zs+1) )^5 + (1/7) * ( (zs-1)/(zs+1) )^7 + 
    (1/9) * ( (zs-1)/(zs+1) )^9 + (1/11) * ( (zs-1)/(zs+1) )^11 + (1/13) * ( (zs-1)/(zs+1) )^13 + (1/15) * ( (zs-1)/(zs+1) )^15 + 
    (1/17) * ( (zs-1)/(zs+1) )^17 + (1/19) * ( (zs-1)/(zs+1) )^19 + (1/21) * ( (zs-1)/(zs+1) )^21
  ) 
x <- zs - 1
tz <- x*(6 + 0.7662*x)/(5.9897 + 3.7658*x)
tz <- 2 * ( (zs-1)/(zs+1)  + (1/3) * ( (zs-1)/(zs+1) )^3)

x <- (zs - 1)/(zs + 1)
tz <- 2* x * (15 - 4*x^2 )/(15 - 9*x^2 )

tz <- 2/15 * (zs - 1)*(43 + 868*zs + 2018 * zs^2 + 868*zs^3 + 43 * zs^4)/
  (1 + 45*zs + 210 * zs^2 + 210 * zs^3 + 45*zs^4 + zs^5)

matplot(zs, cbind(lz,tz), type = "l")
matplot(zs, cbind(lz,tz), type = "l", xlim = c(0, 0.01))

matplot(zs, cbind(lz,lz2), type = "l")

plot(zs, (1 + 45*zs + 210 * zs^2 + 210 * zs^3 + 45*zs^4 + zs^5), type = "l")

max(abs(lz - tz)[zs >= 0.001 & zs < 0.5])
